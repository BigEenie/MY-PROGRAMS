{% extends "base.html" %}

{% block title %}Contact {{ seller.name }} - University Marketplace{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Header -->
            <div class="text-center mb-5">
                <h1 class="display-5 text-primary">
                    <i class="fas fa-shopping-cart me-3"></i>Purchase Product
                </h1>
                <p class="lead text-muted">Contact seller for cash-on-delivery arrangement</p>
            </div>

            <!-- Product Info (if specific product) -->
            {% if product %}
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h4 class="card-title mb-0">
                        <i class="fas fa-box me-2"></i>Product Details
                    </h4>
                </div>
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-3">
                            <img src="{{ product.image }}" 
                                 class="img-fluid rounded" 
                                 alt="{{ product.name }}">
                        </div>
                        <div class="col-md-9">
                            <h3 class="text-primary">{{ product.name }}</h3>
                            <p class="text-muted mb-2">{{ product.description }}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="h3 text-success">{{ product.price|currency }}</span>
                                <div>
                                    <span class="badge bg-primary me-2">{{ product.category }}</span>
                                    <span class="badge bg-secondary">{{ product.condition }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Seller Info -->
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-success text-white">
                    <h4 class="card-title mb-0">
                        <i class="fas fa-user me-2"></i>Seller Information
                    </h4>
                </div>
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-3 text-center">
                            <img src="{{ seller.profile_image }}" 
                                 class="rounded-circle mb-3" 
                                 width="100" height="100" 
                                 alt="{{ seller.name }}">
                            {% if seller.rating > 0 %}
                            <div class="seller-rating">
                                {% for i in range(5) %}
                                    {% if i < seller.rating %}
                                        <i class="fas fa-star text-warning"></i>
                                    {% else %}
                                        <i class="far fa-star text-warning"></i>
                                    {% endif %}
                                {% endfor %}
                                <span class="ms-2 text-muted">({{ "%.1f"|format(seller.rating) }})</span>
                            </div>
                            {% endif %}
                        </div>
                        <div class="col-md-9">
                            <h3 class="text-primary">{{ seller.name }}</h3>
                            <p class="text-muted mb-2">
                                <i class="fas fa-graduation-cap me-1"></i>{{ seller.department }}
                            </p>
                            {% if seller.bio %}
                            <p class="mb-3">{{ seller.bio }}</p>
                            {% endif %}
                            <div class="contact-info">
                                <p class="mb-1">
                                    <i class="fas fa-envelope text-primary me-2"></i>
                                    <a href="mailto:{{ seller.email }}" class="text-decoration-none">{{ seller.email }}</a>
                                </p>
                                <p class="mb-0">
                                    <i class="fas fa-phone text-primary me-2"></i>
                                    <a href="tel:{{ seller.phone }}" class="text-decoration-none">{{ seller.phone }}</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Form -->
            <div class="card shadow">
                <div class="card-header bg-info text-white">
                    <h4 class="card-title mb-0">
                        <i class="fas fa-envelope me-2"></i>Send Purchase Inquiry
                    </h4>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('submit_contact') }}">
                        <input type="hidden" name="seller_id" value="{{ seller.id }}">
                        {% if product %}
                        <input type="hidden" name="product_id" value="{{ product.id }}">
                        {% endif %}
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="buyer_name" class="form-label">
                                        <i class="fas fa-user me-1"></i>Your Name *
                                    </label>
                                    <input type="text" 
                                           class="form-control" 
                                           id="buyer_name" 
                                           name="buyer_name" 
                                           placeholder="Enter your full name"
                                           required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="buyer_email" class="form-label">
                                        <i class="fas fa-envelope me-1"></i>Your Email *
                                    </label>
                                    <input type="email" 
                                           class="form-control" 
                                           id="buyer_email" 
                                           name="buyer_email" 
                                           placeholder="your.email@university.edu"
                                           required>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="buyer_phone" class="form-label">
                                <i class="fas fa-phone me-1"></i>Phone Number (Optional)
                            </label>
                            <input type="tel" 
                                   class="form-control" 
                                   id="buyer_phone" 
                                   name="buyer_phone" 
                                   placeholder="+1 (555) 123-4567">
                        </div>

                        <div class="mb-4">
                            <label for="message" class="form-label">
                                <i class="fas fa-comment me-1"></i>Message *
                            </label>
                            <textarea class="form-control" 
                                      id="message" 
                                      name="message" 
                                      rows="5" 
                                      placeholder="Hi! I'm interested in purchasing {% if product %}{{ product.name }}{% else %}your product{% endif %}. When would be a good time to arrange cash-on-delivery?"
                                      required></textarea>
                        </div>

                        <!-- Cash on Delivery Info -->
                        <div class="alert alert-warning">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Cash on Delivery:</strong> Payment will be made in cash when you receive the product. 
                            The seller will contact you to arrange a convenient meeting location and time.
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="{% if product %}{{ url_for('index') }}{% else %}{{ url_for('seller_profile', seller_id=seller.id) }}{% endif %}" 
                               class="btn btn-outline-secondary me-md-2">
                                <i class="fas fa-arrow-left me-1"></i>Back
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane me-1"></i>Send Inquiry
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Safety Tips -->
            <div class="card mt-4 border-warning">
                <div class="card-header bg-warning text-dark">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-shield-alt me-2"></i>Safety Tips
                    </h5>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled mb-0">
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Meet in safe, public locations on campus
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Inspect the product before payment
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check text-success me-2"></i>
                            Bring exact change when possible
                        </li>
                        <li class="mb-0">
                            <i class="fas fa-check text-success me-2"></i>
                            Trust your instincts - if something feels wrong, walk away
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
